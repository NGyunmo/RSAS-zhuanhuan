# 漏洞报告提取工具V3.0

## 项目介绍

这是一个基于绿盟扫描器的HTML格式漏洞报告中提取信息并导出为CSV文件的工具。该工具能够自动识别HTML报告中的漏洞信息，包括安全级别、漏洞名称、受影响主机、详细描述和修复建议，并将其保存为结构化的CSV文件，便于进一步分析和处理。

## 功能特点

- **自动识别**：自动从HTML报告中提取漏洞相关信息
- **安全级别分类**：识别并分类高危、中危、低危和信息级别的漏洞
- **主机信息提取**：提取受影响的IP地址和主机信息
- **结构化输出**：将提取的信息保存为标准CSV格式
- **交互式操作**：支持命令行参数或交互式输入
- **统计分析**：提供漏洞级别分布和主机影响统计
- **重复文件处理**：自动处理同名文件避免覆盖

## 安装依赖

本工具依赖以下Python库：

```bash
pip install beautifulsoup4
```

## 使用方法

### 方法一：命令行参数

直接在命令行中指定HTML文件路径：

```bash
python zhuanhuan.py 漏洞报告.html
```

### 方法二：交互式使用

运行脚本后，按照提示输入HTML文件路径：

```bash
python zhuanhuan.py
请输入HTML文件路径 (输入'quit'退出): 漏洞报告.html
```

处理完成后，可以选择继续处理其他文件或退出程序。

## 输出结果

程序将生成一个CSV文件，文件名默认为报告中的任务名称，或"漏洞报告"（如果无法提取任务名称）。输出文件包含以下列：

1. **安全级别**：高危/中危/低危/信息
2. **漏洞名称**：漏洞的详细名称
3. **受影响主机**：受影响的IP地址列表
4. **详细描述**：漏洞的详细说明
5. **修复建议**：针对漏洞的修复建议

此外，程序还会在控制台输出统计信息，包括各安全级别的漏洞数量和受影响的主机总数。

## 注意事项

- 请确保HTML文件编码为UTF-8，以避免中文乱码问题
- 如果提取结果不理想，可能是因为HTML报告格式与预期不符
- 输出的CSV文件使用UTF-8-BOM编码，以确保在Excel中正确显示中文

## 打包成可执行文件

如果需要将脚本打包为可执行文件，可以使用PyInstaller：

```bash
pip install pyinstaller
pyinstaller --onefile --console --name "漏洞提取工具V3.0" zhuanhuan.py
```

打包完成后，可以在`dist`目录中找到可执行文件。

## 示例

输入HTML文件包含多个漏洞信息时，程序会提取所有漏洞并保存到CSV文件中，同时在控制台显示提取统计：

```
=== 漏洞报告提取工具V3.0 ===

==================================================
任务名称: 网站安全扫描报告
正在提取漏洞信息...
通过颜色样式找到 15 个漏洞标题
成功提取: 高危 - SQL注入漏洞
成功提取: 高危 - 未授权访问
成功提取: 中危 - XSS漏洞
...

成功提取 15 条漏洞记录
结果已保存到: 网站安全扫描报告.csv

安全级别统计:
  高危: 2 个
  中危: 5 个
  低危: 8 个
总计影响 23 个主机实例

是否继续处理其他文件? (y/n): 
```

## 故障排除

- **文件不存在错误**：请检查输入的文件路径是否正确
- **编码错误**：确保HTML文件编码为UTF-8
- **未找到漏洞数据**：可能是HTML报告格式与工具预期不符，请检查报告格式
- **提取不完整**：如果只提取了部分漏洞，请检查HTML结构是否有特殊变化

## 版本信息

- **V3.0**：优化了漏洞提取逻辑，增加了多种查找方法，提高了提取成功率

## 许可证

本项目为内部工具，仅供授权使用。